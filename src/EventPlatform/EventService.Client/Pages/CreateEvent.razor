@page "/CreateEvent"

@using System.Security.Claims
@using Microsoft.AspNetCore.Components.Authorization

@inject NavigationManager NavigationManager
@inject IEventService EventService

@attribute [Authorize(Roles = "admin")]

<h1>Create a new Event</h1>

<EditForm Model="@_newEvent" OnValidSubmit="@HandleEventCreation">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="form-group">
        <label for="Name">Name</label>
        <InputText id="Name" class="form-control" @bind-Value="_newEvent.Name" />
    </div>

    <div class="form-group">
        <label for="StartDate">Start Date</label>
        <InputDate Type="InputDateType.DateTimeLocal" @bind-Value:format="dd/MM/yyyy hh:mm:ss" @bind-Value="_newEvent.StartDate" />
    </div>

    <div class="form-group">
        <label for="EndDate">End Date</label>
        <InputDate Type="InputDateType.DateTimeLocal" @bind-Value:format="dd/MM/yyyy hh:mm:ss" @bind-Value="_newEvent.EndDate" />
    </div>

    <div class="form-group">
        <label for="Description">Description</label>
        <InputText id="Name" class="form-control" @bind-Value="_newEvent.Description" />
    </div>

    <button class="btn btn-primary" type="submit">Submit</button>
</EditForm>

@code {

    private Event _newEvent = new Event();

    private async Task HandleEventCreation()
    {
        await EventService.CreateEvent(_newEvent);
        NavigationManager.NavigateTo("/");
    }
}
